
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Joseph - Revisión de Informes</title>
  <script src="taskpane.js"></script>
  <link rel="stylesheet" href="taskpane.css" />
</head>
<body>
  <h2>Joseph - Revisión de Informes</h2>
  <button onclick="revisarErrores()">🔍 Revisar errores</button>
  <button onclick="mejorarRedaccion()">📝 Mejorar redacción</button>
  <button onclick="revisarPlanteamiento()">📋 Revisar planteamiento</button>
  <button onclick="finalizar()">✅ Finalizar</button>
  <div id="resultado" style="margin-top: 20px; background:#f9f9f9; border:1px solid #ccc; padding:10px;"></div>
  <div id="consola" style="margin-top: 10px; font-size: 12px; color: #555;"></div>
  <script>
    // Mostrar mensajes de error
    function logMensaje(msg) {
      document.getElementById("consola").innerText = msg;
    }

    // Sobrescribimos fetch para depurar
    const originalFetch = window.fetch;
    window.fetch = async (...args) => {
      logMensaje("Llamando a: " + args[0]);
      try {
        const response = await originalFetch(...args);
        if (!response.ok) throw new Error("Error HTTP " + response.status);
        logMensaje("Respuesta correcta desde el servidor.");
        return response;
      } catch (error) {
        logMensaje("⚠️ Error de conexión: " + error.message);
        throw error;
      }
    };
  </script>
</body>
</html>
